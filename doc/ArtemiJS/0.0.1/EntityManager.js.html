<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: EntityManager.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: EntityManager.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

var Bag = require('./utils/Bag'),
    BitSet = require('./utils/BitSet'),
    Entity = require('./Entity'),
    Manager = require('./Manager');

/**
 * The entity manager class.
 *
 * @class EntityManager
 * @extends Manager
 * @constructor
 * @memberof ArtemiJS
 */
var EntityManager = function EntityManager() {
    Manager.call(this);

    /**
     * @private
     * @property {Utils.Bag} entities
     */
    var entities = new Bag(),

    /**
     * @private
     * @property {Utils.BitSet} disabled
     */
    disabled = new BitSet(),

    /**
     * @private
     * @property {Number} active
     */
    active = 0,

    /**
     * @private
     * @property {Number} added
     */
    added = 0,

    /**
     * @private
     * @property {Number} created
     */
    created = 0,

    /**
     * @private
     * @property {Number} deleted
     */
    deleted = 0,

    /**
     * @private
     * @property {IdentifierPool} identifierPool
     */
    identifierPool = new IdentifierPool();

    /**
     * Initialize
     *
     */
    this.initialize = function() {};

    /**
     * Create new entity instance
     *
     * @return {ArtemiJS.Entity}
     */
    this.createEntityInstance = function() {
        var entity = new Entity(this.world, identifierPool.checkOut());
        ++created;
        return entity;
    };

    /**
     * Set entity as added for future process
     *
     * @param {ArtemiJS.Entity} entity
     */
    this.added = function(entity) {
        ++active;
        ++added;
        entities.set(entity.getId(), entity);
    };

    /**
     * Set entity as enabled for future process
     *
     * @param {ArtemiJS.Entity} entity
     */
    this.enabled = function(entity) {
        disabled.clear(entity.getId());
    };

    /**
     * Set entity as disabled for future process
     *
     * @param {ArtemiJS.Entity} entity
     */
    this.disabled = function(entity) {
        disabled.set(entity.getId());
    };

    /**
     * Set entity as deleted for future process
     *
     * @param {ArtemiJS.Entity} entity
     */
    this.deleted = function(entity) {
        entities.set(entity.getId(), null);

        disabled.clear(entity.getId());

        identifierPool.checkIn(entity.getId());

        --active;
        ++deleted;
    };

    /**
     * Check if this entity is active.
     * Active means the entity is being actively processed.
     *
     * @param {Number} entityId
     * @return {Boolean} true if active, false if not
     */
    this.isActive = function(entityId) {
        return entities.get(entityId) !== null;
    };

    /**
     * Check if the specified entityId is enabled.
     *
     * @param {Number} entityId
     * @return {Boolean} true if enabled, false if it is disabled
     */
    this.isEnabled = function(entityId) {
        return !disabled.get(entityId);
    };

    /**
     * Get a entity with this id.
     *
     * @param {Number} entityId
     * @return {ArtemiJS.Entity}
     */
    this.getEntity = function(entityId) {
        return entities.get(entityId);
    };

    /**
     * Get how many entities are active in this world.
     *
     * @return {Number} how many entities are currently active.
     */
    this.getActiveEntityCount = function() {
        return active;
    };

   /**
     * Get how many entities have been created in the world since start.
     * Note: A created entity may not have been added to the world, thus
     * created count is always equal or larger than added count.
     *
     * @return {Number} how many entities have been created since start.
     */
    this.getTotalCreated = function() {
        return created;
    };

    /**
     * Get how many entities have been added to the world since start.
     *
     * @return {Number} how many entities have been added.
     */
    this.getTotalAdded = function() {
        return added;
    };

    /**
     * Get how many entities have been deleted from the world since start.
     *
     * @return {Number} how many entities have been deleted since start.
     */
    this.getTotalDeleted = function() {
        return deleted;
    };

    /**
     * Used only internally in EntityManager to generate distinct ids for
     * entities and reuse them
     *
     * @class IdentifierPool
     * @constructor
     */
    function IdentifierPool() {

        /**
         * @property {Utils.Bag} ids
         */
        var ids = new Bag(),

        /**
         * @property {Number} nextAvailableId
         */
        nextAvailableId = 0;

        /**
         * Check an available id
         *
         * @return {Number} next available id
         */
        this.checkOut = function() {
            if(ids.size()) {
                return ids.removeLast();
            }
            return ++nextAvailableId;
        };

        /**
         * Add new id in ids {Bag}
         *
         * @param {Number} id
         */
        this.checkIn = function(id) {
            ids.push(id);
        };
    }
};

EntityManager.prototype = Object.create(Manager.prototype);
EntityManager.prototype.constructor = EntityManager;
module.exports = EntityManager;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Artemi.html">Artemi</a></li><li><a href="ArtemiJS.html">ArtemiJS</a></li><li><a href="ArtemiJS.Aspect.html">Aspect</a></li><li><a href="ArtemiJS.ComponentManager.html">ComponentManager</a></li><li><a href="ArtemiJS.ComponentMapper.html">ComponentMapper</a></li><li><a href="ArtemiJS.ComponentType.html">ComponentType</a></li><li><a href="ArtemiJS.Entity.html">Entity</a></li><li><a href="ArtemiJS.EntityManager.html">EntityManager</a></li><li><a href="ArtemiJS.EntityManager-IdentifierPool.html">IdentifierPool</a></li><li><a href="ArtemiJS.EntitySystem.html">EntitySystem</a></li><li><a href="ArtemiJS.Manager.html">Manager</a></li><li><a href="ArtemiJS.World.html">World</a></li><li><a href="EntitySystem.SystemIndexManager.html">SystemIndexManager</a></li><li><a href="IntervalEntitySystem.html">IntervalEntitySystem</a></li><li><a href="Managers.GroupManager.html">GroupManager</a></li><li><a href="Managers.PlayerManager.html">PlayerManager</a></li><li><a href="Managers.TagManager.html">TagManager</a></li><li><a href="Managers.TeamManager.html">TeamManager</a></li><li><a href="Systems.DelayedEntityProcessingSystem.html">DelayedEntityProcessingSystem</a></li><li><a href="Systems.EntityProcessingSystem.html">EntityProcessingSystem</a></li><li><a href="Systems.IntervalEntityProcessingSystem.html">IntervalEntityProcessingSystem</a></li><li><a href="Systems.VoidEntitySystem.html">VoidEntitySystem</a></li><li><a href="Utils.Bag.html">Bag</a></li><li><a href="Utils.BitSet.html">BitSet</a></li><li><a href="Utils.Timer.html">Timer</a></li></ul><h3>Namespaces</h3><ul><li><a href="Managers.html">Managers</a></li><li><a href="Systems.html">Systems</a></li><li><a href="Utils.html">Utils</a></li></ul><h3>Interfaces</h3><ul><li><a href="ArtemiJS.Component.html">Component</a></li></ul><h3>Global</h3><ul><li><a href="global.html#added">added</a></li><li><a href="global.html#changed">changed</a></li><li><a href="global.html#deleted">deleted</a></li><li><a href="global.html#disabled">disabled</a></li><li><a href="global.html#enabled">enabled</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.3</a> on Thu Nov 12 2015 17:44:50 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
